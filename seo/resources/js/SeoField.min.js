function createElement(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=document.createElement(e),r=!0,o=!1,a=void 0;try{for(var s,l=Object.entries(t)[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value,c=slicedToArray(u,2),d=c[0],h=c[1];(void 0===h?"undefined":_typeof(h))!==_typeof(function(){})?i.setAttribute(d,h):i.addEventListener(d,h)}}catch(e){o=!0,a=e}finally{try{!r&&l.return&&l.return()}finally{if(o)throw a}}return Array.isArray(n)||(n=[n]),n.map(function(e){try{i.appendChild(e)}catch(t){i.appendChild(document.createTextNode(e))}}),i}function debounce(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=void 0;return 0===t?function(){e.apply(this,arguments)}:function(){var r=this,o=arguments;"SyntheticEvent"===o[0].constructor.name&&o[0].persist();var a=n&&!i;clearTimeout(i),i=setTimeout(function(){i=null,n||e.apply(r,o)},t),a&&e.apply(r,o)}}function capitalize(e){return e[0].toUpperCase()+e.slice(1)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},asyncGenerator=function(){function e(e){this.value=e}function t(t){function n(r,o){try{var a=t[r](o),s=a.value;s instanceof e?Promise.resolve(s.value).then(function(e){n("next",e)},function(e){n("throw",e)}):i(a.done?"return":"normal",a.value)}catch(e){i("throw",e)}}function i(e,t){switch(e){case"return":r.resolve({value:t,done:!0});break;case"throw":r.reject(t);break;default:r.resolve({value:t,done:!1})}(r=r.next)?n(r.key,r.arg):o=null}var r,o;this._invoke=function(e,t){return new Promise(function(i,a){var s={key:e,arg:t,resolve:i,reject:a,next:null};o?o=o.next=s:(r=o=s,n(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(t){return new e(t)}}}(),classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},slicedToArray=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Tabs=function(){function e(t){var n=this;classCallCheck(this,e),this.activeTab={tab:null,page:null},this.pages={},this.namespace=t;var i=[].slice.call(document.getElementById(this.namespace+"Tabs").getElementsByTagName("a"));this.pages=[].slice.call(document.getElementById(this.namespace+"Pages").children).reduce(function(e,t){return e[t.dataset.seoTab]=t,e},{}),this.setActiveTab(i[0]),i.forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),n.setActiveTab(e)})})}return createClass(e,[{key:"setActiveTab",value:function(e){var t=e.dataset.seoTab;this.activeTab.tab&&(this.activeTab.tab.classList.remove("active"),this.activeTab.page.classList.remove("active")),this.activeTab={tab:e,page:this.pages[t]},this.activeTab.tab.classList.add("active"),this.activeTab.page.classList.add("active")}}]),e}(),TextStatistics=function(){function e(t){classCallCheck(this,e),this.text=t?e.cleanText(t):t}return createClass(e,[{key:"fleschKincaidReadingEase",value:function(){return Math.round(10*(206.835-1.015*this.averageWordsPerSentence()-84.6*this.averageSyllablesPerWord()))/10}},{key:"fleschKincaidGradeLevel",value:function(){return Math.round(10*(.39*this.averageWordsPerSentence()+11.8*this.averageSyllablesPerWord()-15.59))/10}},{key:"gunningFogScore",value:function(){return Math.round(.4*(this.averageWordsPerSentence()+this.percentageWordsWithThreeSyllables(!1))*10)/10}},{key:"colemanLiauIndex",value:function(){return Math.round(10*(this.letterCount()/this.wordCount()*5.89-this.sentenceCount()/this.wordCount()*.3-15.8))/10}},{key:"smogIndex",value:function(){return Math.round(1.043*Math.sqrt(this.wordsWithThreeSyllables()*(30/this.sentenceCount())+3.1291)*10)/10}},{key:"automatedReadabilityIndex",value:function(){return Math.round(10*(this.letterCount()/this.wordCount()*4.71+this.wordCount()/this.sentenceCount()*.5-21.43))/10}},{key:"textLength",value:function(){return this.text.length}},{key:"letterCount",value:function(){return this.text.replace(/[^a-z]+/gi,"").length}},{key:"sentenceCount",value:function(){return this.text.replace(/[^.!?]/g,"").length||1}},{key:"wordCount",value:function(){return this.words().length||1}},{key:"words",value:function(){return this._words?this._words:(this._words=this.text.split(/[^a-z0-9']+/i),this._words)}},{key:"averageWordsPerSentence",value:function(){return this.wordCount()/this.sentenceCount()}},{key:"averageSyllablesPerWord",value:function(){var e=this,t=0,n=this.wordCount();return this.text.split(/\s+/).forEach(function(n){t+=e.syllableCount(n)}),(t||1)/(n||1)}},{key:"wordsWithThreeSyllables",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=0;return t=!1!==t,this.text.split(/\s+/).forEach(function(i){i.match(/^[A-Z]/)&&!t||e.syllableCount(i)>2&&n++}),n}},{key:"percentageWordsWithThreeSyllables",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.wordsWithThreeSyllables(e)/this.wordCount()*100}}],[{key:"cleanText",value:function(e){return["li","p","h1","h2","h3","h4","h5","h6","dd"].forEach(function(t){e.replace("</"+t+">",".")}),e=e.replace(/<[^>]+>/g,"").replace(/[,:;()-]/g," ").replace(/[.!?]/g,".").replace(/^\s+/g,"").replace(/[ ]*(\n|\r\n|\r)[ ]*/g," ").replace(/([.])[. ]+/g,".").replace(/[ ]*([.])/g,". ").replace(/\s+/g," ").replace(/\s+$/g,"").replace(/'/g,""),e+="."}},{key:"syllableCount",value:function(e){var t=0,n=0;e=e.toLowerCase().replace(/[^a-z]/g,"");var i={simile:3,forever:3,shoreline:2};if(i.hasOwnProperty(e))return i[e];var r=[/cial/,/tia/,/cius/,/cious/,/giu/,/ion/,/iou/,/sia$/,/[^aeiuoyt]{2,}ed$/,/.ely$/,/[cg]h?e[rsd]?$/,/rved?$/,/[aeiouy][dt]es?$/,/[aeiouy][^aeiouydt]e[rsd]?$/,/^[dr]e[aeiou][^aeiou]+$/,/[aeiouy]rse$/],o=[/ia/,/riet/,/dien/,/iu/,/io/,/ii/,/[aeiouym]bl$/,/[aeiou]{3}/,/^mc/,/ism$/,/([^aeiouy])\1l$/,/[^l]lien/,/^coa[dglx]./,/[^gq]ua[^auieo]/,/dnt$/,/uity$/,/ie(r|st)$/];[/^un/,/^fore/,/ly$/,/less$/,/ful$/,/ers?$/,/ings?$/].forEach(function(t){e.match(t)&&(e=e.replace(t,""),n++)});var a=e.split(/[^aeiouy]+/gi).filter(function(e){return!!e.replace(/\s+/gi,"").length}).length;return t=a+n,r.forEach(function(n){e.match(n)&&t--}),o.forEach(function(n){e.match(n)&&t++}),t||1}}]),e}(),SEO_RATING={NONE:"neutral",GOOD:"good",AVERAGE:"average",POOR:"poor"},FocusKeywords=function(){function e(t,n){var i=this;classCallCheck(this,e),this.activeKeywordIndex=null,this.onKeywordsChange=function(){var e=Object.values(SEO_RATING).reduce(function(e,t){return e[t]=0,e},{});i.keywordsField.value=JSON.stringify(i.keywords.map(function(t){var n=t.keyword,i=t.score;return e[i]++,{keyword:n,score:i}})),i.scoreField.value=Object.keys(e).reduce(function(t,n){return e[n]>t.score?{rating:n,score:e[n]}:t},{rating:SEO_RATING.NONE,score:0}).rating},this.onKeywordClick=function(e){e.preventDefault(),i.setActiveKeyword(e.target.dataset.index)},this.onKeywordRemoveClick=function(e){e.preventDefault(),e.stopPropagation();var t=0|e.target.parentNode.parentNode.dataset.index;i.activeKeywordIndex===t&&i.setActiveKeyword(0);var n=i.getKeywordElementAtIndex(t);n.parentNode.removeChild(n),i.keywords.splice(t,1),i.keywords=i.keywords.map(function(e,t){return i.activeKeywordIndex===e.index&&(i.activeKeywordIndex=t),i.getKeywordElementAtIndex(t).setAttribute("data-index",t),_extends({},e,{index:t})}),i.onKeywordsChange()},this.onInputWrapClick=function(e){e.target===i.inputWrap&&i.input.focus()},this.onInputFocus=function(){i.inputWrap.classList.add("focused")},this.onInputBlur=function(){i.inputWrap.classList.remove("focused")},this.onInputKeyDown=function(e){if(13===e.keyCode){e.preventDefault();var t=e.target.value.trim(),n=!1;t&&(i.keywords.forEach(function(e){var r=e.keyword,o=e.index;t===r&&(n=!0,i.setActiveKeyword(o))}),!n&&i.createKeyword(t),e.target.value="")}},this.createRating=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div",n=capitalize(e);return createElement(t,{class:"seo--light "+e,title:n},n)},this.createKeyword=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"neutral",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=null!==n?n:i.keywords.length,o=createElement("a",{href:"#",click:i.onKeywordClick,"data-index":r},[i.createRating(t,"span"),e,createElement("object",{},createElement("a",{href:"#",title:"Remove",click:i.onKeywordRemoveClick},"Remove"))]);i.inputWrap.insertBefore(o,i.inputWrap.lastElementChild),null===n&&(i.keywords.push({keyword:e,score:t,index:r}),i.setActiveKeyword(r),i.onKeywordsChange())},this.getKeywordElementAtIndex=function(e){return i.inputWrap.children[e]},this.namespace=t,this.SEO=n,this.keywordsField=document.getElementById(t+"Keywords"),this.scoreField=document.getElementById(t+"Score"),this.initInput(),this.initKeywords()}return createClass(e,[{key:"initInput",value:function(){this.inputWrap=document.getElementById(this.namespace+"KeywordsInput"),this.input=this.inputWrap.lastElementChild,this.inputWrap.addEventListener("click",this.onInputWrapClick),this.input.addEventListener("focus",this.onInputFocus),this.input.addEventListener("blur",this.onInputBlur),this.input.addEventListener("keydown",this.onInputKeyDown)}},{key:"initKeywords",value:function(){var e=this;this.keywords=JSON.parse(this.keywordsField.value).map(function(e,t){return _extends({},e,{index:t})}),this.keywords.forEach(function(t,n){var i=t.keyword,r=t.score;e.createKeyword(i,r,n)}),this.keywords.length&&this.setActiveKeyword(0),this.onKeywordsChange()}},{key:"setActiveKeyword",value:function(e){null!==this.activeKeywordIndex&&this.keywords.length>this.activeKeywordIndex&&this.getKeywordElementAtIndex(this.activeKeywordIndex).classList.remove("active"),this.keywords.length>e&&(this.activeKeywordIndex=0|e,this.getKeywordElementAtIndex(this.activeKeywordIndex).classList.add("active"))}}]),e}(),Snippet=function(){function e(t,n){classCallCheck(this,e),this.namespace=t,this.SEO=n,this.titleField=document.getElementById(t+"Title"),this.slugField=document.getElementById(t+"Slug"),this.descField=document.getElementById(t+"Description"),this.SEO.snippetFields={title:this.titleField,slug:this.slugField,desc:this.descField},this.title(),this.slugField&&this.slug(),this.desc()}return createClass(e,[{key:"title",value:function(){var e=this,t=document.getElementById("title");if(t&&this.titleField.classList.contains("clean")&&this.SEO.options.isNew||""===this.titleField.value.trim()){var n=this.titleField.value,i=function(){e.titleField.value=t.value+" "+n};t.addEventListener("input",i,!1),this.titleField.addEventListener("input",function n(){e.titleField.classList.remove("clean"),t.removeEventListener("input",i,!1),e.titleField.removeEventListener("input",n,!1)},!1)}}},{key:"slug",value:function(){var e=this,t=document.getElementById("slug");if(t){this.slugField.textContent=t.value;var n=function(){e.slugField.textContent=t.value};t.addEventListener("input",n),document.getElementById("title").addEventListener("input",debounce(n,500))}}},{key:"desc",value:function(){var e=this,t=function(){setTimeout(function(){e.descField.style.height="",e.descField.style.height=e.descField.scrollHeight+"px"},1)};if(this.descField.addEventListener("keydown",function(e){13===e.keyCode&&e.preventDefault()}),this.descField.addEventListener("input",function(){e.descField.value=e.descField.value.replace(/(\r\n|\r|\n)/gm," "),e.descField.value.length>160?e.descField.classList.add("invalid"):e.descField.classList.remove("invalid"),t()}),document.getElementById("tabs"))for(var n=document.querySelectorAll("#tabs a.tab"),i=0;i<n.length;i++)n[i].addEventListener("click",t);Craft.livePreview&&(Craft.livePreview.on("enter",t),Craft.livePreview.on("exit",t)),window.addEventListener("resize",t),t()}}]),e}(),SeoField=function(){function e(t,n){classCallCheck(this,e),this.snippetFields={title:null,slug:null,desc:null},this.options={hasPreview:!1,isNew:!1},e.watchForSeoField(t)||(this.options=n,new Tabs(t),new Snippet(t,this),this.options.hasPreview&&new FocusKeywords(t,this))}return createClass(e,null,[{key:"watchForSeoField",value:function(t){if(e.isInitialized)return!0;e.isInitialized=!0;var n=document.getElementById(t+"Field"),i=new MutationObserver(function(t){t.forEach(function(t){t.removedNodes.length&&(e.isInitialized=!1,i.disconnect())})});return i.observe(n.parentNode,{childList:!0}),!1}}]),e}();SeoField.isInitialized=!1,window.SeoField=SeoField;
//# sourceMappingURL=SeoField.min.js.map
