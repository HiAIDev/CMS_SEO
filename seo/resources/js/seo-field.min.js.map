{"version":3,"file":"seo-field.min.js","sources":["../../../resources/js/seo-field.js"],"sourcesContent":["/* global Craft, Garnish, $, module, define */\n\nvar SeoField = function (namespace, hasSection) {\n\tif (window.hasSeoField) return;\n\n\tvar self = this;\n\twindow.hasSeoField = true;\n\n\tthis.namespace = namespace;\n\n\t// Field\n\tdocument.getElementById(namespace + '-field').addEventListener('DOMNodeRemoved', function () {\n\t\twindow.hasSeoField = false;\n\t});\n\n\t// Snippet\n\tthis.title();\n\tthis.slug();\n\tthis.desc();\n\n\tif (hasSection) {\n\n\t\tthis.getHTMLForParsing = new SeoField.GetEntryHTML();\n\n\t\t// Keyword\n\t\tthis.keyword = document.getElementById(namespace + '-keyword');\n\n\t\t// Score\n\t\tthis.score = document.getElementById(namespace + \"-score\");\n\t\tthis.list = document.getElementById(namespace + \"-list\");\n\t\tthis.bar = document.getElementById(namespace + \"-bar\");\n\t\tthis.scoreField = document.getElementById(namespace + \"-score-field\");\n\t\tthis.toggle();\n\n\t\t// Calculate\n\t\tthis.calculateScore();\n\n\t\t// Re-calculate the score every second\n\t\tsetInterval(function () {\n\t\t\tself.calculateScore();\n\t\t}, 1000);\n\n\t}\n};\n\n// SNIPPET\nSeoField.prototype.title = function () {\n\tvar title = this.titleField = document.getElementById(this.namespace + '-title'),\n\t\tt = document.getElementById('title'),\n\t\ttInput, titleInput, self = this;\n\n\ttInput = function () {\n\t\ttitle.value = this.value + ' ' + initial;\n\t};\n\n\ttitleInput = function () {\n\t\tthis.classList.remove('clean');\n\t\tt.removeEventListener('input', tInput, false);\n\t\tthis.removeEventListener('input', titleInput, false);\n\t};\n\n\tif (t && title.classList.contains('clean')) {\n\t\tvar initial = title.value;\n\t\tt.addEventListener('input', tInput, false);\n\t}\n\n\ttitle.addEventListener('input', titleInput, false);\n\n\ttitle.addEventListener('change', function () { self.calculateScore(); });\n};\n\nSeoField.prototype.slug = function () {\n\tvar slug = this.slugField = document.getElementById(this.namespace + '-slug'),\n\t\ts = document.getElementById('slug'),\n\t\tself = this;\n\n\tif (s && slug) {\n\t\tslug.textContent = s.value;\n\n\t\t// On a loop because crafts slug generation doesn't trigger any events\n\t\tsetInterval(function () {\n\t\t\tif (slug.textContent !== s.value) {\n\t\t\t\tslug.textContent = s.value;\n\t\t\t\tself.calculateScore();\n\t\t\t}\n\t\t}, 1000);\n\t}\n};\n\nSeoField.prototype.desc = function () {\n\tvar desc = this.descField = document.getElementById(this.namespace + '-description'),\n\t\tself = this;\n\n\tfunction adjustHeight () {\n\t\tsetTimeout(function () {\n\t\t\tdesc.oninput();\n\t\t}, 1);\n\t}\n\n\t// Set Initial Height\n\tadjustHeight();\n\n\t// Set height on tab change (needed if the field is in a separate tab)\n\tif (document.getElementById('tabs')) {\n\t\t[].slice.call(document.querySelectorAll('#tabs a.tab')).forEach(function (el) {\n\t\t\tel.addEventListener('click', function () {\n\t\t\t\tadjustHeight();\n\t\t\t});\n\t\t});\n\t}\n\n\tif (Craft.livePreview) {\n\t\tCraft.livePreview.on('enter', adjustHeight);\n\t\tCraft.livePreview.on('exit', adjustHeight);\n\t}\n\twindow.addEventListener('resize', adjustHeight);\n\n\t// Disable line breaks\n\tdesc.addEventListener('keydown', function (e) {\n\t\tif (e.keyCode === 13) e.preventDefault();\n\t});\n\n\t// Cleanse line breaks and check length\n\tdesc.addEventListener('input', function () {\n\t\tthis.value = this.value.replace(/(\\r\\n|\\n|\\r)/gm,\" \");\n\t\tif (this.value.length > 160) this.classList.add('invalid');\n\t\telse this.classList.remove('invalid');\n\t});\n\n\tdesc.addEventListener('change', function () { self.calculateScore(); });\n};\n\n// SCORE\nSeoField.prototype.toggle = function () {\n\tvar self = this,\n\t\tisOpen = false;\n\n\tthis.score.getElementsByClassName('toggle-score')[0].addEventListener('click', function () {\n\t\tself.score.classList.toggle('open');\n\t\tisOpen = !isOpen;\n\n\t\tif (isOpen) {\n\t\t\tself.score.getElementsByClassName('details')[0].style.height = self.score.getElementsByClassName('details-inner')[0].clientHeight + 'px';\n\t\t} else {\n\t\t\tself.score.getElementsByClassName('details')[0].style.height = '';\n\t\t}\n\t});\n\n\tthis.toggle.close = function () {\n\t\tself.score.classList.remove('open');\n\t\tisOpen = false;\n\t\tself.score.getElementsByClassName('details')[0].style.height = '';\n\t};\n};\n\nSeoField.prototype.calculateScore = function () {\n\tif (this.keyword && this.keyword.value) {\n\t\tthis.currentScore = {};\n\t\tvar self = this;\n\n\t\tthis.currentScore.titleLength = this.judgeTitleLength();\n\t\tthis.currentScore.titleKeyword = this.judgeTitleKeyword();\n\t\tthis.currentScore.slug = this.judgeSlug();\n\t\tthis.currentScore.desc = this.judgeDesc();\n\n\t\tthis.getHTMLForParsing.update(function (content) {\n\t\t\tif (content.textContent.replace('\\r', '').replace('\\n', '').replace('\\r\\n', '').replace(/\\s+/gi, '') === '') {\n\t\t\t\tself.currentScore.noContent = {\n\t\t\t\t\tscore: SeoField.Levels.BAD,\n\t\t\t\t\treason: 'You have no content, adding some would be a good start!'\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tself.content = content;\n\t\t\t\tself.content.textOnly = self.content.textContent.replace('\\r', ' ').replace('\\n', ' ').replace('\\r\\n', ' ').replace(/\\s+/gi, ' ');\n\t\t\t\tself.content.stats = SeoField.TextStatistics(self.content.textContent);\n\n\t\t\t\tself.currentScore.wordCount = self.judgeWordCount();\n\t\t\t\tself.currentScore.firstParagraph = self.judgeFirstParagraph();\n\t\t\t\tself.currentScore.images = self.judgeImages();\n\t\t\t\tself.currentScore.links = self.judgeLinks();\n\t\t\t\tself.currentScore.headings = self.judgeHeadings();\n\t\t\t\tself.currentScore.density = self.judgeDensity();\n\t\t\t\tself.currentScore.fleschEase = self.judgeFleschEase();\n\t\t\t}\n\n\t\t\tself.getHTMLForParsing.clean();\n\t\t\tself.updateScoreHtml();\n\t\t});\n\t} else {\n\t\tthis.toggle.close();\n\t\tthis.score.classList.add('disabled');\n\t\tthis.scoreField.value = '';\n\t}\n};\n\nSeoField.prototype.updateScoreHtml = function () {\n\tthis.score.classList.remove('disabled');\n\n\tvar sorted = SeoField.sortScore(this.currentScore);\n\tvar sortedScore = sorted.merged;\n\n\tthis.list.innerHTML = '';\n\tfor (var i = 0; i < sortedScore.length; i++) {\n\t\tvar j = sortedScore[i];\n\t\tthis.list.innerHTML += '<li class=\"'+ j.score+'\">' + j.reason + '</li>';\n\t}\n\n\tvar good = this.bar.getElementsByClassName('good')[0],\n\t\tok = this.bar.getElementsByClassName('ok')[0],\n\t\tbad = this.bar.getElementsByClassName('bad')[0];\n\n\tvar goodW = 1 - ((sortedScore.length - sorted.good.length) / sortedScore.length),\n\t\tokW = 1 - ((sortedScore.length - sorted.ok.length) / sortedScore.length),\n\t\tbadW = 1 - ((sortedScore.length - sorted.bad.length) / sortedScore.length);\n\n\tgood.style.transform = 'scale(' + goodW + ', 1)';\n\tok.style.transform = 'translateX(' + (goodW * 100) + '%) scale(' + okW + ', 1)';\n\tbad.style.transform = 'translateX(' + ((goodW + okW) * 100) + '%) scale(' + badW + ', 1)';\n\n\tvar s = '';\n\n\tif (badW > goodW) {\n\t\ts = 'bad';\n\t} else if ((badW + okW) > goodW) {\n\t\ts = 'ok';\n\t} else {\n\t\ts = 'good';\n\t}\n\n\tthis.scoreField.value = s;\n};\n\n// CALCULATOR\nSeoField.prototype.judgeTitleLength = function () {\n\tvar v = this.titleField.value,\n\t\tret;\n\n\tret = {\n\t\tscore : (v.length < 40 || v.length > 60) ? SeoField.Levels.BAD : SeoField.Levels.GOOD,\n\t\treason: (v.length < 40) ? SeoField.Reasons.titleLengthFailMin : (v.length > 60) ? SeoField.Reasons.titleLengthFailMax : SeoField.Reasons.titleLengthSuccess\n\t};\n\tret.reason = ret.reason.replace('{l}', v.length);\n\n\treturn ret;\n};\n\nSeoField.prototype.judgeTitleKeyword = function () {\n\tvar ret;\n\n\tif (this.titleField.value.toLowerCase().indexOf(this.keyword.value.toLowerCase()) > -1) {\n\t\tvar w = this.titleField.value.toLowerCase().split(' '),\n\t\t\tinFirstHalf = false;\n\n\t\tfor (var i = 0; i < w.length/2; i++) {\n\t\t\tif (w[i] === this.keyword.value.toLowerCase()) {\n\t\t\t\tinFirstHalf = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (inFirstHalf) {\n\t\t\tret = {\n\t\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\t\treason: SeoField.Reasons.titleKeywordSuccess\n\t\t\t};\n\t\t} else {\n\t\t\tret = {\n\t\t\t\tscore : SeoField.Levels.OK,\n\t\t\t\treason: SeoField.Reasons.titleKeywordPosFail\n\t\t\t};\n\t\t}\n\t} else {\n\t\tret = {\n\t\t\tscore : SeoField.Levels.BAD,\n\t\t\treason: SeoField.Reasons.titleKeywordFail\n\t\t};\n\t}\n\n\treturn ret;\n};\n\nSeoField.prototype.judgeSlug = function () {\n\tif (!this.slugField) return;\n\n\tif (this.slugField.textContent.toLowerCase().indexOf(this.keyword.value.toLowerCase()) > -1) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\treason: SeoField.Reasons.slugSuccess\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.BAD,\n\t\t\treason: SeoField.Reasons.slugFail\n\t\t};\n\t}\n};\n\n// TODO: Check if keyword in first half / number of times it appears?\nSeoField.prototype.judgeDesc = function () {\n\tif (this.descField.value.toLowerCase().indexOf(this.keyword.value.toLowerCase()) > -1) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\treason: SeoField.Reasons.descSuccess\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.BAD,\n\t\t\treason: SeoField.Reasons.descFail\n\t\t};\n\t}\n};\n\nSeoField.prototype.judgeWordCount = function () {\n\tvar wc = this.content.stats.wordCount();\n\tif (wc > 300) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\treason: SeoField.Reasons.wordCountSuccess.replace('{l}', wc)\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.BAD,\n\t\t\treason: SeoField.Reasons.wordCountFail.replace('{l}', wc)\n\t\t};\n\t}\n};\n\nSeoField.prototype.judgeFirstParagraph = function () {\n\tif (this.content.querySelector('p') && this.content.querySelector('p').textContent.toLowerCase().indexOf(this.keyword.value.toLowerCase()) > -1) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\treason: SeoField.Reasons.firstParagraphSuccess\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.BAD,\n\t\t\treason: SeoField.Reasons.firstParagraphFail\n\t\t};\n\t}\n};\n\nSeoField.prototype.judgeImages = function () {\n\tvar imgs = this.content.getElementsByTagName('img');\n\tif (imgs) {\n\t\tvar imgsWithAltKeyword = 0;\n\n\t\tfor (var i = 0; i < imgs.length; i++) {\n\t\t\tif (imgs[i].getAttribute('alt') &&\n\t\t\t\timgs[i].getAttribute('alt').toLowerCase().indexOf(this.keyword.value.toLowerCase()))\n\t\t\t\timgsWithAltKeyword++;\n\t\t}\n\n\t\tif (imgsWithAltKeyword === imgs.length) {\n\t\t\treturn {\n\t\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\t\treason: SeoField.Reasons.imagesSuccess\n\t\t\t};\n\t\t} else if (imgsWithAltKeyword >= imgs.length/2) {\n\t\t\treturn {\n\t\t\t\tscore : SeoField.Levels.OK,\n\t\t\t\treason: SeoField.Reasons.imagesOk\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tscore : SeoField.Levels.BAD,\n\t\t\t\treason: SeoField.Reasons.imagesFail\n\t\t\t};\n\t\t}\n\t}\n};\n\nSeoField.prototype.judgeLinks = function () {\n\tvar a = this.content.getElementsByTagName('a');\n\n\tif (a) {\n\t\tfor (var i = 0; i < a.length; i++) {\n\t\t\tif (SeoField.isExternalUrl(a[i].href)) {\n\t\t\t\treturn {\n\t\t\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\t\t\treason: SeoField.Reasons.linksSuccess\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\tscore : SeoField.Levels.BAD,\n\t\treason: SeoField.Reasons.linksFail\n\t};\n};\n\nSeoField.prototype.judgeHeadings = function () {\n\tvar headings = this.content.querySelectorAll('h1,h2,h3,h4,h5,h6');\n\n\tif (headings) {\n\t\tvar primary = 0, secondary = 0;\n\n\t\tfor (var i = 0; i < headings.length; i++) {\n\t\t\tif (headings[i].textContent.toLowerCase().indexOf(this.keyword.value.toLowerCase()) > -1) {\n\t\t\t\tif (['H1', 'H2'].indexOf(headings[i].nodeName) > -1) {\n\t\t\t\t\tprimary++;\n\t\t\t\t} else {\n\t\t\t\t\tsecondary++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (primary > 0) {\n\t\t\treturn {\n\t\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\t\treason: SeoField.Reasons.headingsSuccess\n\t\t\t};\n\t\t} else if (secondary > 0) {\n\t\t\treturn {\n\t\t\t\tscore : SeoField.Levels.OK,\n\t\t\t\treason: SeoField.Reasons.headingsOk\n\t\t\t};\n\t\t}\n\t}\n\n\treturn {\n\t\tscore : SeoField.Levels.BAD,\n\t\treason: SeoField.Reasons.headingsFail\n\t};\n};\n\nSeoField.prototype.judgeDensity = function () {\n\tvar words = this.content.stats.words();\n\n\tfunction countInArray (arr, word) {\n\t\tvar c = 0, i = 0;\n\t\tfor (; i < arr.length; i++)\n\t\t\tif (arr[i].toLowerCase() === word) c++;\n\t\treturn c;\n\t}\n\n\tvar keyCount = countInArray(words, this.keyword.value.toLowerCase());\n\n\tvar keyPercent = parseFloat((100 + ((keyCount - words.length) / words.length) * 100).toFixed(2));\n\n\tif (keyPercent < 1.0) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.BAD,\n\t\t\treason: SeoField.Reasons.densityFailUnder.replace('{d}', keyPercent)\n\t\t};\n\t} else if (keyPercent <= 2.5) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\treason: SeoField.Reasons.densitySuccess.replace('{d}', keyPercent)\n\t\t};\n\t} else if (keyPercent > 2.5) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.OK,\n\t\t\treason: SeoField.Reasons.densityOk.replace('{d}', keyPercent).replace('{c}', keyCount)\n\t\t};\n\t}\n\n\treturn {\n\t\tscore : SeoField.Levels.BAD,\n\t\treason: SeoField.Reasons.densityFail\n\t};\n};\n\nSeoField.prototype.judgeFleschEase = function () {\n\tvar level = this.content.stats.fleschKincaidReadingEase();\n\n\tif (level >= 80) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.GOOD,\n\t\t\treason: SeoField.Reasons.fleschSuccess.replace('{l}', level)\n\t\t};\n\t} else if (level >= 60) {\n\t\treturn {\n\t\t\tscore : SeoField.Levels.OK,\n\t\t\treason: SeoField.Reasons.fleschOk.replace('{l}', level)\n\t\t};\n\t}\n\n\treturn {\n\t\tscore : SeoField.Levels.BAD,\n\t\treason: SeoField.Reasons.fleschFail.replace('{l}', level)\n\t};\n};\n\n// HELPERS\nSeoField.Fail = function (message) {\n\tCraft.cp.displayError('<strong>SEO:</strong> ' + message);\n\tif (window.console) console.error.apply(console, ['%cSEO: %c' + message, 'font-weight:bold;','font-weight:normal;']); // eslint-disable-line no-console\n};\n\n/**\n * Get Parsed Fields HTML\n */\nSeoField.GetEntryHTML = function () {\n\tthis.clean();\n};\n\nSeoField.GetEntryHTML.prototype.update = function (cb) {\n\tvar self = this,\n\t\tpostData = Garnish.getPostData(document.getElementById('container'));\n\n\tif (typeof Craft.livePreview === typeof undefined) {\n\t\tthis.score.previousElementSibling.classList.add('hide');\n\t\treturn;\n\t}\n\n\tif (!this.lastPostData || !Craft.compare(postData, this.lastPostData)) {\n\t\tthis.lastPostData = postData;\n\n\t\t$.ajax({\n\t\t\turl: Craft.livePreview.previewUrl,\n\t\t\tmethod: 'POST',\n\t\t\tdata: $.extend({}, postData, Craft.livePreview.basePostData),\n\t\t\txhrFields: {\n\t\t\t\twithCredentials: true\n\t\t\t},\n\t\t\tcrossDomain: true,\n\t\t\tsuccess: function (data) {\n\t\t\t\tdata = data.replace(/<script([^'\"]|\"(\\\\.|[^\"\\\\])*\"|'(\\\\.|[^'\\\\])*')*?<\\/script>/g, '');\n\n\t\t\t\tself.iframe.contentWindow.document.open();\n\t\t\t\tself.iframe.contentWindow.document.write(data);\n\t\t\t\tself.iframe.contentWindow.document.close();\n\n\t\t\t\tif (self.iframe.contentWindow.document.body)\n\t\t\t\t\tcb(self.iframe.contentWindow.document.body);\n\t\t\t\telse\n\t\t\t\t\tSeoField.Fail(\"Unable to calculate score\");\n\t\t\t}\n\t\t});\n\t}\n};\n\nSeoField.GetEntryHTML.prototype.clean = function () {\n\tif (this.iframe)\n\t\tdocument.body.removeChild(this.iframe);\n\n\tthis.iframe = document.createElement('iframe');\n\tthis.iframe.setAttribute('frameborder', '0');\n\tthis.iframe.style.width = '0px';\n\tthis.iframe.style.height = '0px';\n\tdocument.body.appendChild(this.iframe);\n};\n\n/**\n * External URL checker\n * From http://stackoverflow.com/a/9744104/550109\n *\n * @param {string} url\n */\nSeoField.isExternalUrl = (function(){\n\tvar domainRe = /https?:\\/\\/((?:[\\w\\d]+\\.)+[\\w\\d]{2,})/i, res = null;\n\n\treturn function(url) {\n\t\tfunction domain(url) {\n\t\t\treturn (res = domainRe.exec(url)) !== null ? res[1] : false;\n\t\t}\n\n\t\treturn domain(location.href) !== domain(url);\n\t};\n})();\n\n/**\n * Organize the judgements by score\n *\n * @param unsorted\n * @returns {{good: Array, ok: Array, bad: Array, merged: Array.<T>}}\n */\nSeoField.sortScore = function (unsorted) {\n\tvar good = [], ok = [], bad = [];\n\tfor (var key in unsorted) {\n\t\tif (unsorted.hasOwnProperty(key) && unsorted[key]) {\n\t\t\tunsorted[key].key = key;\n\t\t\tswitch (unsorted[key].score) {\n\t\t\t\tcase SeoField.Levels.BAD:\n\t\t\t\t\tbad.push(unsorted[key]);\n\t\t\t\t\tbreak;\n\t\t\t\tcase SeoField.Levels.OK:\n\t\t\t\t\tok.push(unsorted[key]);\n\t\t\t\t\tbreak;\n\t\t\t\tcase SeoField.Levels.GOOD:\n\t\t\t\t\tgood.push(unsorted[key]);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\tgood: good,\n\t\tok: ok,\n\t\tbad: bad,\n\t\tmerged: good.concat(ok.concat(bad))\n\t};\n};\n\n/**\n * TextStatistics.js\n * Christopher Giffard (2012)\n * 1:1 API Fork of TextStatistics.php by Dave Child (Thanks mate!)\n * https://github.com/DaveChild/Text-Statistics\n *\n * Modified by Tam<hi@tam.sx>\n */\n(function(glob) {\n\n\tfunction cleanText(text) {\n\t\t// all these tags should be preceeded by a full stop.\n\t\tvar fullStopTags = ['li', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'dd'];\n\n\t\tfullStopTags.forEach(function(tag) {\n\t\t\ttext = text.replace(\"</\" + tag + \">\",\".\");\n\t\t});\n\n\t\ttext = text\n\t\t\t.replace(/<[^>]+>/g, \"\")\t\t\t\t// Strip tags\n\t\t\t.replace(/[,:;()\\-]/, \" \")\t\t\t\t// Replace commas, hyphens etc (count them as spaces)\n\t\t\t.replace(/’/g, \"'\")                     // Replace ’ with '\n\t\t\t.replace(/[\\.!?]/, \".\")\t\t\t\t\t// Unify terminators\n\t\t\t.replace(/^\\s+/,\"\")\t\t\t\t\t\t// Strip leading whitespace\n\t\t\t.replace(/[ ]*(\\n|\\r\\n|\\r)[ ]*/,\" \")\t// Replace new lines with spaces\n\t\t\t.replace(/([\\.])[\\. ]+/,\".\")\t\t\t// Check for duplicated terminators\n\t\t\t.replace(/[ ]*([\\.])/,\". \")\t\t\t\t// Pad sentence terminators\n\t\t\t.replace(/\\s+/,\" \")\t\t\t\t\t\t// Remove multiple spaces\n\t\t\t.replace(/\\s+$/,\"\");\t\t\t\t\t// Strip trailing whitespace\n\n\t\ttext += \".\"; // Add final terminator, just in case it's missing.\n\n\t\treturn text;\n\t}\n\n\tvar TextStatistics = function TextStatistics(text) {\n\t\tthis.text = text ? cleanText(text) : this.text;\n\t};\n\n\tTextStatistics.prototype.fleschKincaidReadingEase = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn Math.round((206.835 - (1.015 * this.averageWordsPerSentence(text)) - (84.6 * this.averageSyllablesPerWord(text)))*10)/10;\n\t};\n\n\tTextStatistics.prototype.fleschKincaidGradeLevel = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn Math.round(((0.39 * this.averageWordsPerSentence(text)) + (11.8 * this.averageSyllablesPerWord(text)) - 15.59)*10)/10;\n\t};\n\n\tTextStatistics.prototype.gunningFogScore = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn Math.round(((this.averageWordsPerSentence(text) + this.percentageWordsWithThreeSyllables(text, false)) * 0.4)*10)/10;\n\t};\n\n\tTextStatistics.prototype.colemanLiauIndex = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn Math.round(((5.89 * (this.letterCount(text) / this.wordCount(text))) - (0.3 * (this.sentenceCount(text) / this.wordCount(text))) - 15.8 ) *10)/10;\n\t};\n\n\tTextStatistics.prototype.smogIndex = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn Math.round(1.043 * Math.sqrt((this.wordsWithThreeSyllables(text) * (30 / this.sentenceCount(text))) + 3.1291)*10)/10;\n\t};\n\n\tTextStatistics.prototype.automatedReadabilityIndex = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn Math.round(((4.71 * (this.letterCount(text) / this.wordCount(text))) + (0.5 * (this.wordCount(text) / this.sentenceCount(text))) - 21.43)*10)/10;\n\t};\n\n\tTextStatistics.prototype.textLength = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn text.length;\n\t};\n\n\tTextStatistics.prototype.letterCount = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\ttext = text.replace(/[^a-z]+/ig,\"\");\n\t\treturn text.length;\n\t};\n\n\tTextStatistics.prototype.sentenceCount = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\n\t\t// Will be tripped up by \"Mr.\" or \"U.K.\". Not a major concern at this point.\n\t\treturn text.replace(/[^\\.!?]/g, '').length || 1;\n\t};\n\n\tTextStatistics.prototype.wordCount = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn text.split(/[^a-z0-9']+/i).length || 1;\n\t};\n\n\tTextStatistics.prototype.words = function () {\n\t\tif (this._words) return this._words;\n\t\treturn this._words = this.text.split(/[^a-z0-9']+/i); // jshint ignore:line\n\t};\n\n\tTextStatistics.prototype.averageWordsPerSentence = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\treturn this.wordCount(text) / this.sentenceCount(text);\n\t};\n\n\tTextStatistics.prototype.averageSyllablesPerWord = function(text) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\tvar syllableCount = 0, wordCount = this.wordCount(text), self = this;\n\n\t\ttext.split(/\\s+/).forEach(function(word) {\n\t\t\tsyllableCount += self.syllableCount(word);\n\t\t});\n\n\t\t// Prevent NaN...\n\t\treturn (syllableCount||1) / (wordCount||1);\n\t};\n\n\tTextStatistics.prototype.wordsWithThreeSyllables = function(text, countProperNouns) {\n\t\ttext = text ? cleanText(text) : this.text;\n\t\tvar longWordCount = 0, self = this;\n\n\t\tcountProperNouns = countProperNouns === false ? false : true;\n\n\t\ttext.split(/\\s+/).forEach(function(word) {\n\n\t\t\t// We don't count proper nouns or capitalised words if the countProperNouns attribute is set.\n\t\t\t// Defaults to true.\n\t\t\tif (!word.match(/^[A-Z]/) || countProperNouns) {\n\t\t\t\tif (self.syllableCount(word) > 2) longWordCount ++;\n\t\t\t}\n\t\t});\n\n\t\treturn longWordCount;\n\t};\n\n\tTextStatistics.prototype.percentageWordsWithThreeSyllables = function(text, countProperNouns) {\n\t\ttext = text ? cleanText(text) : this.text;\n\n\t\treturn (this.wordsWithThreeSyllables(text,countProperNouns) / this.wordCount(text)) * 100;\n\t};\n\n\tTextStatistics.prototype.syllableCount = function(word) {\n\t\tvar syllableCount = 0,\n\t\t\tprefixSuffixCount = 0,\n\t\t\twordPartCount = 0;\n\n\t\t// Prepare word - make lower case and remove non-word characters\n\t\tword = word.toLowerCase().replace(/[^a-z]/g,\"\");\n\n\t\t// Specific common exceptions that don't follow the rule set below are handled individually\n\t\t// Array of problem words (with word as key, syllable count as value)\n\t\tvar problemWords = {\n\t\t\t\"simile\":\t\t3,\n\t\t\t\"forever\":\t\t3,\n\t\t\t\"shoreline\":\t2\n\t\t};\n\n\t\t// Return if we've hit one of those...\n\t\tif (problemWords.hasOwnProperty(word)) return problemWords[word];\n\n\t\t// These syllables would be counted as two but should be one\n\t\tvar subSyllables = [\n\t\t\t/cial/,\n\t\t\t/tia/,\n\t\t\t/cius/,\n\t\t\t/cious/,\n\t\t\t/giu/,\n\t\t\t/ion/,\n\t\t\t/iou/,\n\t\t\t/sia$/,\n\t\t\t/[^aeiuoyt]{2,}ed$/,\n\t\t\t/.ely$/,\n\t\t\t/[cg]h?e[rsd]?$/,\n\t\t\t/rved?$/,\n\t\t\t/[aeiouy][dt]es?$/,\n\t\t\t/[aeiouy][^aeiouydt]e[rsd]?$/,\n\t\t\t/^[dr]e[aeiou][^aeiou]+$/, // Sorts out deal, deign etc\n\t\t\t/[aeiouy]rse$/ // Purse, hearse\n\t\t];\n\n\t\t// These syllables would be counted as one but should be two\n\t\tvar addSyllables = [\n\t\t\t/ia/,\n\t\t\t/riet/,\n\t\t\t/dien/,\n\t\t\t/iu/,\n\t\t\t/io/,\n\t\t\t/ii/,\n\t\t\t/[aeiouym]bl$/,\n\t\t\t/[aeiou]{3}/,\n\t\t\t/^mc/,\n\t\t\t/ism$/,\n\t\t\t/([^aeiouy])\\1l$/,\n\t\t\t/[^l]lien/,\n\t\t\t/^coa[dglx]./,\n\t\t\t/[^gq]ua[^auieo]/,\n\t\t\t/dnt$/,\n\t\t\t/uity$/,\n\t\t\t/ie(r|st)$/\n\t\t];\n\n\t\t// Single syllable prefixes and suffixes\n\t\tvar prefixSuffix = [\n\t\t\t/^un/,\n\t\t\t/^fore/,\n\t\t\t/ly$/,\n\t\t\t/less$/,\n\t\t\t/ful$/,\n\t\t\t/ers?$/,\n\t\t\t/ings?$/\n\t\t];\n\n\t\t// Remove prefixes and suffixes and count how many were taken\n\t\tprefixSuffix.forEach(function(regex) {\n\t\t\tif (word.match(regex)) {\n\t\t\t\tword = word.replace(regex,\"\");\n\t\t\t\tprefixSuffixCount ++;\n\t\t\t}\n\t\t});\n\n\t\twordPartCount = word\n\t\t\t.split(/[^aeiouy]+/ig)\n\t\t\t.filter(function(wordPart) {\n\t\t\t\treturn !!wordPart.replace(/\\s+/ig,\"\").length;\n\t\t\t})\n\t\t\t.length;\n\n\t\t// Get preliminary syllable count...\n\t\tsyllableCount = wordPartCount + prefixSuffixCount;\n\n\t\t// Some syllables do not follow normal rules - check for them\n\t\tsubSyllables.forEach(function(syllable) {\n\t\t\tif (word.match(syllable)) syllableCount --;\n\t\t});\n\n\t\taddSyllables.forEach(function(syllable) {\n\t\t\tif (word.match(syllable)) syllableCount ++;\n\t\t});\n\n\t\treturn syllableCount || 1;\n\t};\n\n\tfunction textStatistics(text) {\n\t\treturn new TextStatistics(text);\n\t}\n\n\t(typeof module != \"undefined\" && module.exports) ? (module.exports = textStatistics) : (typeof define != \"undefined\" ? (define(\"textstatistics\", [], function() { return textStatistics; })) : (glob.TextStatistics = textStatistics)); // jshint ignore:line\n})(SeoField);\n\n// CONSTS / ENUMS\nSeoField.Levels = {\n\tNONE: '',\n\tGOOD: 'good',\n\tOK: 'ok',\n\tBAD: 'bad'\n};\n\nSeoField.Reasons = {\n\ttitleLengthFailMin: 'The title contains {l} characters which is less than the recommended minimum of 40 characters.',\n\ttitleLengthFailMax: 'The title contains {l} characters which is greater than the recommended maximum of 60 characters.',\n\ttitleLengthSuccess: 'The title is between the recommended minimum and maximum length.',\n\n\ttitleKeywordFail: 'The title does not contain the keyword. Try adding it near the beginning of the title.',\n\ttitleKeywordSuccess: 'The title contains the keyword near the beginning.',\n\ttitleKeywordPosFail: 'The title contains the keyword, but not near the beginning. Try to move it closer to the start of the title.',\n\n\tslugFail: 'The URL does not contain the keyword. Try adding it to the slug.',\n\tslugSuccess: 'The URL contains the keyword.',\n\n\tdescFail: 'The description does not contain the keyword. Try adding it near the beginning of the description.',\n\tdescSuccess: 'The description contains the keyword.',\n\n\twordCountFail: 'Your text contains {l} words, this is less than the recommended 300 word minimum.',\n\twordCountSuccess: 'Your text contains {l} words, this is more than the recommended 300 word minimum.',\n\n\tfirstParagraphFail: 'The keyword does not appear in the first paragraph of your text. Try adding it.',\n\tfirstParagraphSuccess: 'The keyword appears in the first paragraph of your text.',\n\n\timagesFail: 'Less than half of the images have alt tags containing the keyword, try adding it to more images.',\n\timagesOk: 'Half or more of the images have alt tags containing the keyword. To improve this, try adding keywords to all the images alt tags.',\n\timagesSuccess: 'All of the images have alt tags containing the keyword.',\n\n\tlinksFail: 'The page does not contain any outgoing links. Try adding some.',\n\tlinksSuccess: 'The page contains outgoing links.',\n\n\theadingsFail: 'The page does not contain any headings that contain the keyword. Try adding some with the keyword.',\n\theadingsOk: 'The page contains some lower importance headings that contain the keyword. Try adding the keyword to some h2\\'s.',\n\theadingsSuccess: 'The page contains higher importance headings with the keyword.',\n\n\tdensityFail: 'The keyword does not appear in the text. It is important to include it in your content.',\n\tdensityFailUnder: 'The keyword density is {d}%, which is well under the advised 2.5%. Try increasing the number of times the keyword is used.',\n\tdensityOk: 'The keyword density is {d}%, which is over the advised 2.5%. The keyword appears {c} times.',\n\tdensitySuccess: 'The keyword density is {d}%, which is near the advised 2.5%.',\n\n\tfleschFail: 'The Flesch Reading ease score is {l} which is considered best for university graduates. Try reducing your sentence length to improve readability.',\n\tfleschOk: 'The Flesch Reading ease score is {l} which is average, and considered easily readable by most users.',\n\tfleschSuccess: 'The Flesch Reading ease score is {l} meaning your content is readable by all ages.',\n};\n"],"names":["SeoField","namespace","hasSection","window","hasSeoField","self","this","getElementById","addEventListener","title","slug","desc","getHTMLForParsing","GetEntryHTML","keyword","document","score","list","bar","scoreField","toggle","calculateScore","prototype","tInput","titleInput","titleField","t","value","initial","classList","remove","removeEventListener","contains","slugField","s","textContent","adjustHeight","oninput","descField","slice","call","querySelectorAll","forEach","el","Craft","livePreview","on","e","keyCode","preventDefault","replace","length","add","isOpen","getElementsByClassName","style","height","clientHeight","close","currentScore","titleLength","judgeTitleLength","titleKeyword","judgeTitleKeyword","judgeSlug","judgeDesc","update","content","noContent","Levels","BAD","textOnly","stats","TextStatistics","wordCount","judgeWordCount","firstParagraph","judgeFirstParagraph","images","judgeImages","links","judgeLinks","headings","judgeHeadings","density","judgeDensity","fleschEase","judgeFleschEase","clean","updateScoreHtml","sorted","sortScore","sortedScore","merged","innerHTML","i","j","reason","good","ok","bad","goodW","okW","badW","transform","ret","v","GOOD","Reasons","titleLengthFailMin","titleLengthFailMax","titleLengthSuccess","toLowerCase","indexOf","w","split","inFirstHalf","titleKeywordSuccess","OK","titleKeywordPosFail","titleKeywordFail","slugSuccess","slugFail","descSuccess","descFail","wc","wordCountSuccess","wordCountFail","querySelector","firstParagraphSuccess","firstParagraphFail","imgs","getElementsByTagName","imgsWithAltKeyword","getAttribute","imagesSuccess","imagesOk","imagesFail","a","isExternalUrl","href","linksSuccess","linksFail","primary","secondary","nodeName","headingsSuccess","headingsOk","headingsFail","words","keyCount","arr","word","c","keyPercent","parseFloat","toFixed","densityFailUnder","densitySuccess","densityOk","densityFail","level","fleschKincaidReadingEase","fleschSuccess","fleschOk","fleschFail","Fail","message","cp","displayError","console","error","apply","cb","postData","Garnish","getPostData","babelHelpers.typeof","lastPostData","compare","ajax","previewUrl","$","extend","basePostData","data","iframe","contentWindow","open","write","body","previousElementSibling","removeChild","createElement","setAttribute","width","appendChild","domainRe","res","url","domain","exec","location","unsorted","key","hasOwnProperty","push","concat","glob","cleanText","text","tag","textStatistics","Math","round","averageWordsPerSentence","averageSyllablesPerWord","fleschKincaidGradeLevel","gunningFogScore","percentageWordsWithThreeSyllables","colemanLiauIndex","letterCount","sentenceCount","smogIndex","sqrt","wordsWithThreeSyllables","automatedReadabilityIndex","textLength","_words","syllableCount","countProperNouns","longWordCount","match","prefixSuffixCount","wordPartCount","problemWords","subSyllables","addSyllables","regex","filter","wordPart","syllable","module","exports","define"],"mappings":"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"}